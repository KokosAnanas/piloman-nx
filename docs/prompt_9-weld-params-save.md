
# Задача: редактирование параметров стыка и сохранение изменений

Виджет `app-weld-params-widget` сейчас просто отображает параметры стыка. Нужно превратить его в редактируемую форму и добавить возможность сохранять изменения.

## 1) Кнопка «Сохранить изменения» в шапке карточки

- В шаблоне `weld-params-widget.component.html` внутри `<ng-template pTemplate="header">` добавь кнопку PrimeNG `<p-button>` справа от заголовка на этой же строчке.
  - Используй атрибут `label="Сохранить изменения"`, вид `rounded` и иконку `pi-check` для обозначения действия.
  - По умолчанию кнопка должна быть неактивна (`[disabled]="!form.dirty"`), активируется при наличии несохранённых изменений.
  - Повесь на неё `(onClick)="onSave()"` для вызова метода сохранения.

- В классе `WeldParamsWidgetComponent` создай метод `onSave()` и используй `WeldsApiService.update(this.weldId, this.form.value)` для отправки обновлённых данных. После успешного обновления сбрось состояние `form.markAsPristine()`, обнови локальный объект `weld` и покажи уведомление об успехе (можно через `MessageService` PrimeNG).

## 2) Преврати вывод параметров в форму

- Замените статические выводы (`<span>{{ weld.property }}</span>`) на элементы управления формы:
  - Для текстовых значений — `<p-inputText>`, для числовых — `<p-inputNumber>`.
  - Для полей «Способ сварки» и «Тип соединения» используй `<p-dropdown>` с перечислением возможных значений.
  - Организуй поля внутри `FormGroup` и задай каждому `formControlName`.

- Сконфигурируй `FormGroup` через `FormBuilder` в конструкторе, инициализировав контролы значениями из входного `@Input() weld`. Подпишись на `form.valueChanges`, чтобы отслеживать изменения.

## 3) Подсветка изменённых полей

- Для каждого поля добавь условный класс, например `[ngClass]="{'bg-yellow-50 dark:bg-yellow-900 border-yellow-500': control.dirty}"`, чтобы подсветить изменённые значения.
- Можно добавить иконку `pi-exclamation-circle` рядом с названием поля, если `control.dirty` истинно.
- Когда пользователь возвращает значение к исходному, подсветка и иконка должны исчезать.

## 4) Логика активации кнопки

- Используй свойство `form.dirty` у `FormGroup`: пока форма не изменялась, кнопка «Сохранить изменения» должна быть отключена.
- Как только хотя бы одно поле станет `dirty`, кнопка становится активной.

## 5) Сохранение данных и уведомления

- Метод `onSave()` должен отправлять только изменённые поля (разницу между `form.value` и исходным объектом `weld`), чтобы не перезаписывать неизменённые данные.
- После успешного сохранения обнови локальный объект `weld`, вызови `form.reset(this.weld)` для сброса состояния формы и отключи кнопку до следующего изменения.
- В случае ошибки сохрани информативное сообщение об ошибке.

## 6) Учёт тем и пресетов

- Соблюдай правила темы и пресетов, описанные в предыдущем промте: не используй «жёсткие» цвета, полагайся на CSS‑переменные PrimeNG и Tailwind‑классы (`bg-surface-0`, `text-color`, `border-color`), чтобы виджет корректно выглядел во всех пресетах Aura/Lara/Nora и в тёмном режиме【557887302887188†L411-L422】.
- Все стили должны задаваться через Tailwind в атрибуте `class=""`, без inline‑стилей【557887302887188†L444-L446】.

### Acceptance Criteria

- В шапке виджета отображается кнопка «Сохранить изменения». Она неактивна, пока поля формы не изменены, и становится активной при наличии несохранённых изменений.
- Изменённые поля подсвечиваются (например, жёлтой заливкой и/или иконкой «!»). При возврате значения к исходному подсветка исчезает.
- Нажатие на активную кнопку сохраняет изменения через `WeldsApiService.update()`, отправляя только изменённые поля, и отключает кнопку до следующих правок.
- Виджет использует компоненты PrimeNG и Tailwind‑классы, поддерживает пресеты тем (Aura, Lara, Nora) и тёмный режим【557887302887188†L411-L422】.

---

Этот промт поможет разработчику корректно реализовать редактирование параметров и сохранение изменений в виджете, соблюдая архитектуру Nx и дизайн‑систему проекта.
