/**
 * Weld (Сварное соединение / Стык) - основная сущность домена "Реестр сварных соединений"
 *
 * Типы/интерфейсы используются как на фронтенде (Angular), так и могут переиспользоваться
 * для типизации на бэкенде (NestJS).
 *
 * @see ГОСТ Р ИСО 17635 — Неразрушающий контроль сварных соединений
 * @see https://docs.nestjs.com/techniques/mongodb#model-injection — NestJS Mongoose
 */

/**
 * Способ сварки (Welding Process)
 * - SMAW_GMAW: Ручная дуговая / Полуавтоматическая (РД/ПАС)
 * - GTAW: Автоматическая в защитных газах (АрД)
 * - SAW: Автоматическая под флюсом (АФ)
 */
export type WeldingProcess = 'SMAW_GMAW' | 'GTAW' | 'SAW';

/**
 * Уровень качества сварного соединения по ГОСТ
 * - A: Высший уровень качества
 * - B: Средний уровень качества
 * - C: Базовый уровень качества
 */
export type QualityLevel = 'A' | 'B' | 'C';

/**
 * Статус сварного соединения в процессе производства
 */
export type WeldStatus = 'draft' | 'in_progress' | 'done';

/**
 * Методы неразрушающего контроля (НК)
 * - VT: Визуальный и измерительный контроль (ВИК)
 * - UT: Ультразвуковой контроль (УЗК)
 * - RT: Радиографический контроль (РК)
 * - MT: Магнитопорошковый контроль (МК)
 * - PT: Капиллярный контроль / Пенетрантный (ПВК)
 *
 * @see ГОСТ Р ИСО 17635 — виды неразрушающего контроля
 */
export type TestMethod = 'VT' | 'UT' | 'RT' | 'MT' | 'PT';

/**
 * Заключение по результатам контроля
 * - OK: Годен
 * - REPAIR: Требуется ремонт
 * - CUT: Подлежит вырезке
 */
export type WeldConclusion = 'OK' | 'REPAIR' | 'CUT';

/**
 * Тип сварного соединения (Joint Type)
 * - BUTT: Стыковое соединение
 * - FILLET_LAP: Угловое / Нахлёсточное соединение
 */
export type JointType = 'BUTT' | 'FILLET_LAP';

/**
 * Основная сущность: Сварное соединение (Weld / Стык)
 *
 * Представляет запись в реестре сварных соединений.
 * Содержит информацию о геометрии, способе сварки, методах контроля и заключении.
 */
export interface Weld {
  /** Уникальный идентификатор (MongoDB ObjectId → string) */
  id: string;

  /** Название объекта строительства */
  objectName?: string;

  /** Наименование организации подрядчика */
  contractor?: string;

  /** Наименование организации заказчика */
  customer?: string;

  /** Номер стыка/шва, например "12-45" — основной бизнес-идентификатор */
  weldNumber: string;

  /** Наружный диаметр трубы, мм (D) */
  diameter: number;

  /** Толщина стенки первого элемента, мм (S1) */
  thickness1: number;

  /** Толщина стенки второго элемента, мм (S2) — для разнотолщинных соединений */
  thickness2?: number;

  /** Уровень качества: A, B или C */
  qualityLevel: QualityLevel;

  /** Дата выполнения сварки (ISO string). null = дата явно не определена */
  weldDate?: string | null;

  /** Способ сварки. По умолчанию: SMAW_GMAW (ручная дуговая / полуавтоматическая) */
  weldingProcess: WeldingProcess;

  /** Статус: черновик, в работе, завершён */
  weldStatus?: WeldStatus;

  /** Методы НК, которыми выполнен контроль. Пустой массив = контроль не запланирован */
  testMethods: TestMethod[];

  /** Заключение по результатам контроля. undefined = контроль не проводился */
  conclusion?: WeldConclusion;

  /** Тип сварного соединения. По умолчанию: BUTT (стыковое) */
  joint?: JointType;

  /** Примечания / комментарии */
  notes?: string;

  /** Дата создания записи (автоматически) */
  createdAt?: string;

  /** Дата последнего обновления (автоматически) */
  updatedAt?: string;
}
