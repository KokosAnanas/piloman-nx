/**
 * Глобальные стили приложения piloman.ru
 *
 * @see https://tailwindcss.com/docs/installation — TailwindCSS
 * @see https://primeng.org/installation — PrimeNG v21
 */

/**
 * CSS Layers для правильного приоритета стилей.
 * Порядок: tailwind-base → primeng → tailwind-utilities
 * Tailwind utilities имеют наивысший приоритет и переопределяют PrimeNG без !important.
 *
 * @see https://primeng.org/theming#csslayer
 * @see https://tailwindcss.com/docs/adding-custom-styles#using-css-and-layer
 */
@layer tailwind-base, primeng, tailwind-utilities;

/* TailwindCSS base layer */
@layer tailwind-base {
  @tailwind base;
}

/* TailwindCSS components */
@tailwind components;

/* TailwindCSS utilities layer (высший приоритет) */
@layer tailwind-utilities {
  @tailwind utilities;
}

/**
 * PrimeIcons
 * @see https://primeng.org/icons
 */
@import 'primeicons/primeicons.css';

/**
 * PrimeNG v21 использует новую систему тем через @primeuix/themes
 * Тема настраивается в app.config.ts через providePrimeNG()
 *
 * @see https://primeng.org/installation — PrimeNG v21 Installation
 * @see https://primeng.org/theming — Theming
 */

/**
 * CSS переменные для layout.
 * Используют дизайн-токены PrimeNG (--p-*).
 *
 * Light mode (дефолт)
 */
:root {
  /* Фон приложения */
  --surface-ground: var(--p-surface-100);
  --surface-section: var(--p-surface-0);

  /* Контент */
  --surface-card: var(--p-content-background);
  --surface-overlay: var(--p-overlay-background);
  --surface-border: var(--p-content-border-color);
  --surface-hover: var(--p-content-hover-background);

  /* Текст */
  --text-color: var(--p-text-color);
  --text-color-secondary: var(--p-text-muted-color);

  /* Скругления */
  --border-radius: var(--p-content-border-radius);

  /* Анимации */
  --transition-duration: 0.2s;
}

/**
 * Dark mode
 * Активируется добавлением класса .app-dark на <html>
 */
:root.app-dark {
  --surface-ground: var(--p-surface-950);
  --surface-section: var(--p-surface-900);
}

/* Глобальные стили */
html {
  font-size: 14px;
}

body {
  font-family: var(--p-font-family, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen,
    Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif);
  margin: 0;
  padding: 0;
  background-color: var(--surface-ground);
  color: var(--text-color);
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* Плавные переходы для темы */
body,
.layout-wrapper,
.layout-topbar,
.layout-sidebar,
.layout-main-container {
  transition: background-color var(--transition-duration),
              color var(--transition-duration),
              border-color var(--transition-duration);
}

/* Скроллбар для Webkit браузеров */
::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

::-webkit-scrollbar-track {
  background: var(--surface-ground);
}

::-webkit-scrollbar-thumb {
  background-color: var(--surface-border);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background-color: var(--text-color-secondary);
}

/**
 * Карточка в стиле PrimeNG (Sakai-like)
 * Использует CSS переменные темы для консистентности с любым пресетом
 */
.card-border {
  border: 1px solid var(--surface-border);
  border-radius: var(--border-radius);
  background-color: var(--surface-card);
  overflow: hidden;
}

/**
 * Глобальные переопределения PrimeNG компонентов
 * Используем @layer primeng для корректного приоритета стилей
 * (Tailwind utilities > primeng > tailwind-base)
 *
 * Убираем min-width у form controls для корректной работы в table-fixed
 * @see https://primeng.org/theming#csslayer
 */
@layer primeng {
  /* p-select: убираем min-width для работы в фиксированных колонках */
  p-select .p-select {
    min-width: 0;
    width: 100%;
  }

  /* p-multiselect: убираем min-width */
  p-multiselect .p-multiselect {
    min-width: 0;
    width: 100%;
  }

  /* p-datepicker: убираем min-width */
  p-datepicker .p-datepicker {
    min-width: 0;
    width: 100%;
  }

  /* p-inputnumber: убираем min-width */
  p-inputnumber .p-inputnumber {
    min-width: 0;
    width: 100%;
  }

  /* p-inputnumber input: убираем min-width */
  p-inputnumber .p-inputnumber-input {
    min-width: 0;
    width: 100%;
  }
}

